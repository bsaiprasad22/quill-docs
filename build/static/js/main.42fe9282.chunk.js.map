{"version":3,"sources":["TextEditor.js","App.js","index.js"],"names":["TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","documentId","useParams","id","useState","socket","setSocket","quill","setQuill","useEffect","s","io","disconnect","once","document","setContents","enable","emit","interval","setInterval","getContents","clearInterval","handler","delta","oldDelta","source","on","off","updateContents","wrapperRef","useCallback","wrapper","innerHTML","editor","createElement","appendChild","q","Quill","theme","modules","toolbar","disable","setText","className","Button","variant","href","onClick","dummy","text","window","location","body","value","select","execCommand","removeChild","ref","App","path","exact","to","uuidv4","component","ReactDOM","render","StrictMode","getElementById"],"mappings":"gPAQMA,EAAkB,CACtB,CAAC,CAAEC,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAC9B,CAAC,CAAEC,KAAM,KACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,OAAQ,SAAU,aACnB,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,CAAEC,OAAQ,SAAW,CAAEA,OAAQ,QAChC,CAAC,CAAEC,MAAO,KACV,CAAC,aAAc,cACf,CAAC,UA4GYC,MAzGf,WACE,IAAYC,EAAeC,cAAnBC,GACR,EAA4BC,qBAA5B,mBAAOC,EAAP,KAAeC,EAAf,KACA,EAA0BF,qBAA1B,mBAAOG,EAAP,KAAcC,EAAd,KAEAC,qBAAU,WACR,IAAMC,EAAIC,aAAG,KAEb,OADAL,EAAUI,GACH,WACLA,EAAEE,gBAEH,IAEHH,qBAAU,WACM,MAAVJ,GAA2B,MAATE,IAEtBF,EAAOQ,KAAK,iBAAiB,SAACC,GAC5BP,EAAMQ,YAAYD,GAClBP,EAAMS,YAGRX,EAAOY,KAAK,eAAgBhB,MAC3B,CAACI,EAAQE,EAAON,IAEnBQ,qBAAU,WACR,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CAEA,IAAMW,EAAWC,aAAY,WAC3Bd,EAAOY,KAAK,gBAAiBV,EAAMa,iBAzCnB,KA4ClB,OAAO,WACLC,cAAcH,OAEf,CAACb,EAAQE,IAEZE,qBAAU,WACR,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CACA,IAAMe,EAAU,SAACC,EAAOC,EAAUC,GACjB,SAAXA,GACJpB,EAAOY,KAAK,eAAgBM,IAI9B,OAFAhB,EAAMmB,GAAG,cAAeJ,GAEjB,WACLf,EAAMoB,IAAI,cAAeL,OAE1B,CAACf,EAAOF,IAEXI,qBAAU,WACR,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CACA,IAAMe,EAAU,SAACC,GACfhB,EAAMqB,eAAeL,IAIvB,OAFAlB,EAAOqB,GAAG,kBAAmBJ,GAEtB,WACLjB,EAAOsB,IAAI,kBAAmBL,OAE/B,CAACf,EAAOF,IAEX,IAAMwB,EAAaC,uBAAY,SAACC,GAC9B,GAAe,MAAXA,EAAJ,CACAA,EAAQC,UAAY,GACpB,IAAMC,EAASnB,SAASoB,cAAc,OACtCH,EAAQI,YAAYF,GACpB,IAAMG,EAAI,IAAIC,IAAMJ,EAAQ,CAC1BK,MAAO,OACPC,QAAS,CAAEC,QAAShD,KAEtB4C,EAAEK,UACFL,EAAEM,QAAQ,cACVlC,EAAS4B,MACR,IAEH,OACE,mCACE,sBAAKO,UAAU,MAAf,UACE,sBAAKA,UAAU,SAAf,UACE,cAACC,EAAA,EAAD,CAAQC,QAAQ,YAAYC,KAAK,IAAjC,qBAGA,4CACA,cAACF,EAAA,EAAD,CACEC,QAAQ,YACRE,QAAS,WACP,IAAIC,EAAQlC,SAASoB,cAAc,SACjCe,EAAOC,OAAOC,SAASL,KAEzBhC,SAASsC,KAAKjB,YAAYa,GAC1BA,EAAMK,MAAQJ,EACdD,EAAMM,SACNxC,SAASyC,YAAY,QACrBzC,SAASsC,KAAKI,YAAYR,IAV9B,0BAgBF,qBAAKL,UAAU,YAAYc,IAAK5B,U,uBC/FzB6B,MAbf,WACE,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,IAAIC,OAAK,EAArB,SACE,cAAC,IAAD,CAAUC,GAAE,qBAAgBC,mBAE9B,cAAC,IAAD,CAAOH,KAAK,iBAAiBI,UAAW/D,UCdhDgE,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFpD,SAASqD,eAAe,W","file":"static/js/main.42fe9282.chunk.js","sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\r\nimport Quill from \"quill\";\r\nimport \"quill/dist/quill.snow.css\";\r\nimport { io } from \"socket.io-client\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { Button } from \"@material-ui/core\";\r\n\r\nconst SAVE_INTERVAL = 2000;\r\nconst TOOLBAR_OPTIONS = [\r\n  [{ header: [1, 2, 3, 4, 5, 6, false] }],\r\n  [{ font: [] }],\r\n  [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n  [\"bold\", \"italic\", \"underline\"],\r\n  [{ color: [] }, { background: [] }],\r\n  [{ script: \"super\" }, { script: \"sub\" }],\r\n  [{ align: [] }],\r\n  [\"blockquote\", \"code-block\"],\r\n  [\"clean\"],\r\n];\r\n\r\nfunction TextEditor() {\r\n  const { id: documentId } = useParams();\r\n  const [socket, setSocket] = useState();\r\n  const [quill, setQuill] = useState();\r\n\r\n  useEffect(() => {\r\n    const s = io(\"/\");\r\n    setSocket(s);\r\n    return () => {\r\n      s.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (socket == null || quill == null) return;\r\n\r\n    socket.once(\"load-document\", (document) => {\r\n      quill.setContents(document);\r\n      quill.enable();\r\n    });\r\n\r\n    socket.emit(\"get-document\", documentId);\r\n  }, [socket, quill, documentId]);\r\n\r\n  useEffect(() => {\r\n    if (socket == null || quill == null) return;\r\n\r\n    const interval = setInterval(() => {\r\n      socket.emit(\"save-document\", quill.getContents());\r\n    }, SAVE_INTERVAL);\r\n\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, [socket, quill]);\r\n\r\n  useEffect(() => {\r\n    if (socket == null || quill == null) return;\r\n    const handler = (delta, oldDelta, source) => {\r\n      if (source !== \"user\") return;\r\n      socket.emit(\"send-changes\", delta);\r\n    };\r\n    quill.on(\"text-change\", handler);\r\n\r\n    return () => {\r\n      quill.off(\"text-change\", handler);\r\n    };\r\n  }, [quill, socket]);\r\n\r\n  useEffect(() => {\r\n    if (socket == null || quill == null) return;\r\n    const handler = (delta) => {\r\n      quill.updateContents(delta);\r\n    };\r\n    socket.on(\"recieve-changes\", handler);\r\n\r\n    return () => {\r\n      socket.off(\"recieve-changes\", handler);\r\n    };\r\n  }, [quill, socket]);\r\n\r\n  const wrapperRef = useCallback((wrapper) => {\r\n    if (wrapper == null) return;\r\n    wrapper.innerHTML = \"\";\r\n    const editor = document.createElement(\"div\");\r\n    wrapper.appendChild(editor);\r\n    const q = new Quill(editor, {\r\n      theme: \"snow\",\r\n      modules: { toolbar: TOOLBAR_OPTIONS },\r\n    });\r\n    q.disable();\r\n    q.setText(\"Loading...\");\r\n    setQuill(q);\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"top\">\r\n        <div className=\"header\">\r\n          <Button variant=\"contained\" href=\"/\">\r\n            New Doc\r\n          </Button>\r\n          <h2>Quill Docs</h2>\r\n          <Button\r\n            variant=\"contained\"\r\n            onClick={() => {\r\n              var dummy = document.createElement(\"input\"),\r\n                text = window.location.href;\r\n\r\n              document.body.appendChild(dummy);\r\n              dummy.value = text;\r\n              dummy.select();\r\n              document.execCommand(\"copy\");\r\n              document.body.removeChild(dummy);\r\n            }}\r\n          >\r\n            Copy Link\r\n          </Button>\r\n        </div>\r\n        <div className=\"container\" ref={wrapperRef}></div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default TextEditor;\r\n","import TextEditor from \"./TextEditor\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from \"react-router-dom\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport \"./styles.css\";\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/\" exact>\n          <Redirect to={`/documents/${uuidv4()}`} />\n        </Route>\n        <Route path=\"/documents/:id\" component={TextEditor} />\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"],"sourceRoot":""}